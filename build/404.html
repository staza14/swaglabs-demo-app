<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="robots" content="noindex">
    <title>Single Page Apps for GitHub Pages</title>
    <script type="text/javascript">
      // Single Page Apps for GitHub Pages
      // MIT License
      // https://github.com/rafgraph/spa-github-pages
      // This script takes the current url and converts the path and query
      // string into just a query string, and then redirects the browser
      // to the new url with only a query string and hash fragment,
      // e.g. https://www.foo.tld/one/two?a=b&c=d#qwe, becomes
      // https://www.foo.tld/?/one/two&a=b~and~c=d#qwe
      // Note: this 404.html file must be at least 512 bytes for it to work
      // with Internet Explorer (it is currently > 512 bytes)

      // If you're creating a Project Pages site and NOT using a custom domain,
      // then set pathSegmentsToKeep to 1 (enterprise users may need to set it to > 1).
      // This way the code will only replace the route part of the path, and not
      // the real directory in which the app resides, for example:
      // https://username.github.io/repo-name/one/two?a=b&c=d#qwe becomes
      // https://username.github.io/repo-name/?/one/two&a=b~and~c=d#qwe
      // Otherwise, leave pathSegmentsToKeep as 0.
      var pathSegmentsToKeep = 0;

      var l = window.location;

      // If the path is explicitly for storybook, don't touch it
      if (l.pathname.indexOf('/storybook') !== 0) {
        // Build origin
        var origin = l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '');

        // Split pathname into segments (skip leading empty segment from the leading slash)
        var segments = l.pathname.split('/').filter(function (s) { return s.length > 0; });

        // Keep the first `pathSegmentsToKeep` segments as the base (for project pages)
        var baseSegments = segments.slice(0, pathSegmentsToKeep);
        var routeSegments = segments.slice(pathSegmentsToKeep);

        // Rebuild base path (leading slash only if there are base segments)
        var base = baseSegments.length ? '/' + baseSegments.join('/') : '';

        // Redirect when the pathname contains '/v1' (case-insensitive) per request
        var containsV1 = l.pathname && l.pathname.toLowerCase().indexOf('/v1') !== -1;

        if (containsV1) {
          var redirectUrlRoot = origin + base + '/?/';
          l.replace(redirectUrlRoot);
        } else {
          // No 'v1' found: proceed with the normal SPA redirect behavior
          // Remove any exact 'v1' path segments just in case (no-op if none exist)
          var filteredRouteSegments = routeSegments.filter(function (s) { return s !== 'v1'; });

          // Encode route and original search by replacing & with ~and~ (keeps compatibility with SPA decoding)
          var encodedRoute = filteredRouteSegments.join('/').replace(/&/g, '~and~');
          var encodedSearch = l.search ? '&' + l.search.slice(1).replace(/&/g, '~and~') : '';
          var hash = l.hash || '';

          // Construct redirect URL. If there is no base (site root), base is '', so this becomes origin + '/?/'...
          var redirectUrlFull = origin + base + '/?/' + encodedRoute + encodedSearch + hash;

          l.replace(redirectUrlFull);
        }
      } else {
        // Do not redirect storybook paths
      }
    </script>
</head>
<body>
</body>
</html>
